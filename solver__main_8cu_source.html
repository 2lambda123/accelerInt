<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>accelerInt: C:/Users/Nick/Dropbox/accelerInt/generic/solver_main.cu Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">accelerInt
   &#160;<span id="projectnumber">v0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_6646d5d5edc224bb18b97caffb429c3d.html">generic</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">solver_main.cu</div>  </div>
</div><!--header-->
<div class="contents">
<a href="solver__main_8cu.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/* Include common code. */</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;stdbool.h&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;complex.h&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;fenv.h&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/* Include CUDA libraries. */</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;cuda.h&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;cuda_runtime.h&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;helper_cuda.h&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;cuComplex.h&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//our code</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="header_8cuh.html">header.cuh</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="timer_8h.html">timer.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//get our solver stuff</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="solver_8cuh.html">solver.cuh</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="gpu__memory_8cuh.html">gpu_memory.cuh</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="read__initial__conditions_8cuh.html">read_initial_conditions.cuh</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="launch__bounds_8cuh.html">launch_bounds.cuh</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#ifdef DIVERGENCE_TEST</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">    #include &lt;assert.h&gt;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">//  internal integrator steps per thread</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="solver__main_8cu.html#a67cdbf6535bef9d8f0227e8340e7fe0a">   42</a></span>&#160;    __device__ <span class="keywordtype">int</span> <a class="code" href="solver__main_8cu.html#a67cdbf6535bef9d8f0227e8340e7fe0a">integrator_steps</a>[<a class="code" href="solver__options_8cuh.html#afd8c973bc66908100d15f47ae514ed41">DIVERGENCE_TEST</a>] = {0};</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="solver__main_8cu.html#a4f005e7918ecc7f1cd2424fb1708b2ca">   57</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="solver__main_8cu.html#a4f005e7918ecc7f1cd2424fb1708b2ca">write_log</a>(<span class="keywordtype">int</span> NUM, <span class="keywordtype">double</span> t, <span class="keyword">const</span> <span class="keywordtype">double</span>* y_host, FILE* pFile)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    fwrite(&amp;t, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), 1, pFile);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">double</span> buffer[<a class="code" href="header_8cuh.html#a170755e30c36be4904106b7bb279b1ec">NN</a>];</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; NUM; j++)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordtype">double</span> Y_N = 1.0;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        buffer[0] = y_host[j];</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="header_8cuh.html#aa86864581d2574ded23a182874b81f4c">NSP</a>; ++i)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            buffer[i] = y_host[NUM * i + j];</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            Y_N -= buffer[i];</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">        #if NN == NSP + 1 //pyjac</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        buffer[<a class="code" href="header_8cuh.html#aa86864581d2574ded23a182874b81f4c">NSP</a>] = Y_N;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="namespacevan__der__pol__cu.html#a0bf56007d0b7d30d68223d2febfcc090">apply_reverse_mask</a>(&amp;buffer[1]);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        fwrite(buffer, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), <a class="code" href="header_8cuh.html#a170755e30c36be4904106b7bb279b1ec">NN</a>, pFile);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="solver__main_8cu.html#a8baeaa804b9d16c49da2b8c74fbd6680">   94</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="solver__main_8cu.html#a8baeaa804b9d16c49da2b8c74fbd6680">memcpy2D_in</a>(<span class="keywordtype">double</span>* dst, <span class="keyword">const</span> <span class="keywordtype">int</span> pitch_dst, <span class="keywordtype">double</span> <span class="keyword">const</span> * src, <span class="keyword">const</span> <span class="keywordtype">int</span> pitch_src,</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">int</span> offset, <span class="keyword">const</span> <span class="keywordtype">size_t</span> width, <span class="keyword">const</span> <span class="keywordtype">int</span> height) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; height; ++i)</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        memcpy(dst, &amp;src[offset], width);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        dst += pitch_dst;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        src += pitch_src;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="solver__main_8cu.html#acfaf06165e3e00cb81ebbcd80ee9c23f">  120</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="solver__main_8cu.html#acfaf06165e3e00cb81ebbcd80ee9c23f">memcpy2D_out</a>(<span class="keywordtype">double</span>* dst, <span class="keyword">const</span> <span class="keywordtype">int</span> pitch_dst, <span class="keywordtype">double</span> <span class="keyword">const</span> * src, <span class="keyword">const</span> <span class="keywordtype">int</span> pitch_src,</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">int</span> offset, <span class="keyword">const</span> <span class="keywordtype">size_t</span> width, <span class="keyword">const</span> <span class="keywordtype">int</span> height) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; height; ++i)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        memcpy(&amp;dst[offset], src, width);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        dst += pitch_dst;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        src += pitch_src;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="solver__main_8cu.html#a0ddf1224851353fc92bfbff6f499fa97">  148</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="solver__main_8cu.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;{</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">//enable signaling NAN and other bad numerics tracking for easier debugging</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    feenableexcept(FE_DIVBYZERO | FE_INVALID | FE_OVERFLOW);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">int</span> NUM = 1;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// check for problem size given as command line option</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (argc &gt; 1)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordtype">int</span> problemsize = NUM;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">if</span> (sscanf(argv[1], <span class="stringliteral">&quot;%i&quot;</span>, &amp;problemsize) != 1 || (problemsize &lt;= 0))</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            printf(<span class="stringliteral">&quot;Error: Problem size not in correct range\n&quot;</span>);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            printf(<span class="stringliteral">&quot;Provide number greater than 0\n&quot;</span>);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            exit(1);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        NUM = problemsize;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// set &amp; initialize device using command line argument (if any)</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    cudaDeviceProp devProp;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (argc &lt;= 2)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">// default device id is 0</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a> (cudaSetDevice (0) );</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a> (cudaGetDeviceProperties(&amp;devProp, 0));</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="comment">// use second argument for number</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">// get number of devices</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordtype">int</span> num_devices;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        cudaGetDeviceCount(&amp;num_devices);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">if</span> (sscanf(argv[2], <span class="stringliteral">&quot;%i&quot;</span>, &amp;<span class="keywordtype">id</span>) == 1 &amp;&amp; (<span class="keywordtype">id</span> &gt;= 0) &amp;&amp; (<span class="keywordtype">id</span> &lt; num_devices))</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>( cudaSetDevice (<span class="keywordtype">id</span>) );</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="comment">// not in range, error</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            printf(<span class="stringliteral">&quot;Error: GPU device number not in correct range\n&quot;</span>);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            printf(<span class="stringliteral">&quot;Provide number between 0 and %i\n&quot;</span>, num_devices - 1);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            exit(1);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a> (cudaGetDeviceProperties(&amp;devProp, <span class="keywordtype">id</span>));</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>( cudaDeviceReset() );</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>( cudaPeekAtLastError() );</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>( cudaDeviceSynchronize() );</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">    #ifdef DIVERGENCE_TEST</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        NUM = <a class="code" href="solver__options_8cuh.html#afd8c973bc66908100d15f47ae514ed41">DIVERGENCE_TEST</a>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        assert(NUM % 32 == 0);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">//bump up shared mem bank size</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>(cudaDeviceSetSharedMemConfig(cudaSharedMemBankSizeEightByte));</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">//and L1 size</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>(cudaDeviceSetCacheConfig(cudaFuncCachePreferL1));</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">size_t</span> size_per_thread = <a class="code" href="namespacevan__der__pol__cu.html#ad0a58342699dfa097a60b242293f4934">required_mechanism_size</a>() + <a class="code" href="namespacegenericcu.html#a95e70ae54ccfc5eb00792846ca80ecde">required_solver_size</a>();</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">size_t</span> free_mem = 0;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">size_t</span> total_mem = 0;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>( cudaMemGetInfo (&amp;free_mem, &amp;total_mem) );</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">//conservatively estimate the maximum allowable threads</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">int</span> max_threads = int(floor(0.8 * ((<span class="keywordtype">double</span>)free_mem) / ((<span class="keywordtype">double</span>)size_per_thread)));</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacegenericcu.html#aebd994cd8979f067bd672588910d33b5">padded</a> = min(NUM, max_threads);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">//padded is next factor of block size up</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    padded = int(ceil(padded / <span class="keywordtype">float</span>(<a class="code" href="launch__bounds_8cuh.html#ae53274b00308b1ad9b200ad750383abd">TARGET_BLOCK_SIZE</a>)) * <a class="code" href="launch__bounds_8cuh.html#ae53274b00308b1ad9b200ad750383abd">TARGET_BLOCK_SIZE</a>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (padded == 0)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        printf(<span class="stringliteral">&quot;Mechanism is too large to fit into global CUDA memory... exiting.&quot;</span>);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        exit(-1);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="structsolver__memory.html">solver_memory</a>* <a class="code" href="namespacegenericcu.html#ab055dd890b1213d13abf8c541e4a09eb">host_solver</a>, *<a class="code" href="namespacegenericcu.html#acb75b0bf572d5107ee76511410038a46">device_solver</a>;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    mechanism_memory* <a class="code" href="namespacegenericcu.html#ab05c3172a90dd7ba99f0829b5940e52e">host_mech</a>, *<a class="code" href="namespacegenericcu.html#a8afbde3cf8ec319556ccaa155d260d48">device_mech</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    host_solver = (<a class="code" href="structsolver__memory.html">solver_memory</a>*)malloc(<span class="keyword">sizeof</span>(<a class="code" href="structsolver__memory.html">solver_memory</a>));</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    host_mech = (mechanism_memory*)malloc(<span class="keyword">sizeof</span>(mechanism_memory));</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="namespacevan__der__pol__cu.html#a335500438eecc1a53d27911bdb50bd6e">initialize_gpu_memory</a>(padded, &amp;host_mech, &amp;device_mech);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="namespacecvode.html#abe146525cea80d8032cd30b4441b5872">initialize_solver</a>(padded, &amp;host_solver, &amp;device_solver);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// print number of threads and block size</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    printf (<span class="stringliteral">&quot;# threads: %d \t block size: %d\n&quot;</span>, NUM, TARGET_BLOCK_SIZE);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#ifdef SHUFFLE</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* filename = <span class="stringliteral">&quot;shuffled_data.bin&quot;</span>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#elif !defined(SAME_IC)</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* filename = <span class="stringliteral">&quot;ign_data.bin&quot;</span>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">double</span>* y_host;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">double</span>* var_host;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#ifdef SAME_IC</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="namespacevan__der__pol__cu.html#aa12c20164ea5113a104bfe974fa7147a">set_same_initial_conditions</a>(NUM, &amp;y_host, &amp;var_host);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="read__initial__conditions_8c.html#a79be377a219a9ab2ae5c3a313b33afed">read_initial_conditions</a>(filename, NUM, &amp;y_host, &amp;var_host);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">//grid sizes</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    dim3 <a class="code" href="namespacegenericcu.html#a3bd8f6f5ff530e0031fad8d4771c3324">dimBlock</a>(TARGET_BLOCK_SIZE, 1);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    dim3 <a class="code" href="namespacegenericcu.html#a5dd31ddb679f9bc301355945a04698db">dimGrid</a> (padded / TARGET_BLOCK_SIZE, 1 );</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">int</span>* <a class="code" href="namespacegenericcu.html#a5f7029a718ffe15c6904855ec8344fde">result_flag</a> = (<span class="keywordtype">int</span>*)malloc(padded * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">// flag for ignition</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">#ifdef IGN</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">bool</span> ign_flag = <span class="keyword">false</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// ignition delay time, units [s]</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">double</span> t_ign = 0.0;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">double</span> T0 = y_host[0];</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">#ifdef LOG_OUTPUT</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// file for data</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    FILE *pFile;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* f_name = <a class="code" href="namespacecvode.html#a3a26024b8dc2ce6f8b2afcfb7c82c79f">solver_name</a>();</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordtype">int</span> len = strlen(f_name);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordtype">char</span> out_name[len + 13];</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    sprintf(out_name, <span class="stringliteral">&quot;log/%s-log.bin&quot;</span>, f_name);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    pFile = fopen(out_name, <span class="stringliteral">&quot;wb&quot;</span>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="solver__main_8cu.html#a4f005e7918ecc7f1cd2424fb1708b2ca">write_log</a>(NUM, 0, y_host, pFile);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">//initialize integrator specific log</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="namespacecvode.html#a9113d5fb0e19fa927d73b64c397ecd09">init_solver_log</a>();</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">double</span>* <a class="code" href="namespacegenericcu.html#a9a062af7a496f339320cfccf270a7c0e">y_temp</a> = 0;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    y_temp = (<span class="keywordtype">double</span>*)malloc(padded * <a class="code" href="header_8cuh.html#aa86864581d2574ded23a182874b81f4c">NSP</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// start timer</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="timer_8h.html#a66509b494102a5c28ba6c8be3eab7733">StartTimer</a>();</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// set initial time</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">double</span> t = 0;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">double</span> t_next = fmin(<a class="code" href="solver__options_8cuh.html#a25526ead9bdb589c90e7a8d3b4d1a746">end_time</a>, <a class="code" href="solver__options_8cuh.html#aaeb7127cf3bf0b49cec6554fbc101866">t_step</a>);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordtype">int</span> numSteps = 0;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">// time integration loop</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">while</span> (t + <a class="code" href="solver__interface_8cuh.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> &lt; <a class="code" href="solver__options_8cuh.html#a25526ead9bdb589c90e7a8d3b4d1a746">end_time</a>)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        numSteps++;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordtype">int</span> num_solved = 0;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">while</span> (num_solved &lt; NUM)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordtype">int</span> num_cond = min(NUM - num_solved, padded);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>( cudaMemcpy (host_mech-&gt;var, &amp;var_host[num_solved],</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                        num_cond * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), cudaMemcpyHostToDevice));</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;             <span class="comment">//copy our memory into y_temp</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <a class="code" href="solver__main_8cu.html#a8baeaa804b9d16c49da2b8c74fbd6680">memcpy2D_in</a>(y_temp, padded, y_host, NUM,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                            num_solved, num_cond * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), <a class="code" href="header_8cuh.html#aa86864581d2574ded23a182874b81f4c">NSP</a>);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="comment">// transfer memory to GPU</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>( cudaMemcpy2D (host_mech-&gt;y, padded * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                                            y_temp, padded * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                            num_cond * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), <a class="code" href="header_8cuh.html#aa86864581d2574ded23a182874b81f4c">NSP</a>,</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                            cudaMemcpyHostToDevice) );</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            intDriver &lt;&lt;&lt; dimGrid, dimBlock, SHARED_SIZE &gt;&gt;&gt; (num_cond, t, t_next, host_mech-&gt;var, host_mech-&gt;y, <a class="code" href="namespacegenericcu.html#a8afbde3cf8ec319556ccaa155d260d48">device_mech</a>, <a class="code" href="namespacegenericcu.html#acb75b0bf572d5107ee76511410038a46">device_solver</a>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">    #ifdef DEBUG</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>( cudaPeekAtLastError() );</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>( cudaDeviceSynchronize() );</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="comment">// copy the result flag back</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>( cudaMemcpy(result_flag, host_solver-&gt;result, num_cond * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), cudaMemcpyDeviceToHost) );</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <a class="code" href="namespacegenericcu.html#af403dabfc12de79ff9ab8575983d6f83">check_error</a>(num_cond, result_flag);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <span class="comment">// transfer memory back to CPU</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>( cudaMemcpy2D (y_temp, padded * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                            host_mech-&gt;y, padded * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                            num_cond * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), <a class="code" href="header_8cuh.html#aa86864581d2574ded23a182874b81f4c">NSP</a>,</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                            cudaMemcpyDeviceToHost) );</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <a class="code" href="solver__main_8cu.html#acfaf06165e3e00cb81ebbcd80ee9c23f">memcpy2D_out</a>(y_host, NUM, y_temp, padded,</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                            num_solved, num_cond * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), <a class="code" href="header_8cuh.html#aa86864581d2574ded23a182874b81f4c">NSP</a>);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            num_solved += num_cond;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        t = t_next;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        t_next = fmin(<a class="code" href="solver__options_8cuh.html#a25526ead9bdb589c90e7a8d3b4d1a746">end_time</a>, (numSteps + 1) * <a class="code" href="solver__options_8cuh.html#aaeb7127cf3bf0b49cec6554fbc101866">t_step</a>);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="preprocessor">    #if defined(PRINT)</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            printf(<span class="stringliteral">&quot;%.15le\t%.15le\n&quot;</span>, t, y_host[0]);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="preprocessor">    #ifdef DEBUG</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="comment">// check if within bounds</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keywordflow">if</span> ((y_host[0] &lt; 0.0) || (y_host[0] &gt; 10000.0))</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                printf(<span class="stringliteral">&quot;Error, out of bounds.\n&quot;</span>);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                printf(<span class="stringliteral">&quot;Time: %e, ind %d val %e\n&quot;</span>, t, 0, y_host[0]);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor">    #ifdef LOG_OUTPUT</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">            #if !defined(LOG_END_ONLY)</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <a class="code" href="solver__main_8cu.html#a4f005e7918ecc7f1cd2424fb1708b2ca">write_log</a>(NUM, t, y_host, pFile);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <a class="code" href="namespacecvode.html#af7eb796b6829fecab506fb6dfec39be0">solver_log</a>();</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">            #endif</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="preprocessor">    #ifdef IGN</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="comment">// determine if ignition has occurred</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="keywordflow">if</span> ((y_host[0] &gt;= (T0 + 400.0)) &amp;&amp; !(ign_flag)) {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                ign_flag = <span class="keyword">true</span>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                t_ign = t;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="preprocessor">#ifdef LOG_END_ONLY</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="solver__main_8cu.html#a4f005e7918ecc7f1cd2424fb1708b2ca">write_log</a>(NUM, t, y_host, pFile);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="namespacecvode.html#af7eb796b6829fecab506fb6dfec39be0">solver_log</a>();</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// end timer</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">double</span> runtime = <a class="code" href="timer_8h.html#ab9a9e5a3142f8bbd781192e032d74c66">GetTimer</a>();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">    #ifdef DIVERGENCE_TEST</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordtype">int</span> host_integrator_steps[<a class="code" href="solver__options_8cuh.html#afd8c973bc66908100d15f47ae514ed41">DIVERGENCE_TEST</a>];</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>( cudaMemcpyFromSymbol(host_integrator_steps, <a class="code" href="solver__main_8cu.html#a67cdbf6535bef9d8f0227e8340e7fe0a">integrator_steps</a>, <a class="code" href="solver__options_8cuh.html#afd8c973bc66908100d15f47ae514ed41">DIVERGENCE_TEST</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)) );</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">int</span> warps = NUM / 32;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    FILE *dFile;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* f_name = <a class="code" href="namespacecvode.html#a3a26024b8dc2ce6f8b2afcfb7c82c79f">solver_name</a>();</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordtype">int</span> len = strlen(f_name);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordtype">char</span> out_name[len + 13];</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    sprintf(out_name, <span class="stringliteral">&quot;log/%s-div.txt&quot;</span>, f_name);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    dFile = fopen(out_name, <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordtype">int</span> index = 0;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; warps; ++i)</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordtype">double</span> d = 0;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordtype">int</span> max = 0;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 32; ++j)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keywordtype">int</span> steps = host_integrator_steps[index];</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            d += steps;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            max = steps &gt; max ? steps : max;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            index++;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        d /= (32.0 * max);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        fprintf(dFile, <span class="stringliteral">&quot;%.15e\n&quot;</span>, d);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    }</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    fclose(dFile);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    runtime /= 1000.0;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    printf (<span class="stringliteral">&quot;Time: %.15e sec\n&quot;</span>, runtime);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    runtime = runtime / ((double)(numSteps));</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    printf (<span class="stringliteral">&quot;Time per step: %e (s)\t%.15e (s/thread)\n&quot;</span>, runtime, runtime / NUM);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="preprocessor">#ifdef IGN</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    printf (<span class="stringliteral">&quot;Ig. Delay (s): %e\n&quot;</span>, t_ign);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    printf(<span class="stringliteral">&quot;TFinal: %e\n&quot;</span>, y_host[0]);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor">#ifdef LOG_OUTPUT</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    fclose (pFile);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="namespacevan__der__pol__cu.html#a40f4f15256b20b377f4b76c325eceae2">free_gpu_memory</a>(&amp;host_mech, &amp;device_mech);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="namespacecvode.html#ac9bc4957bff6721dae9d7e4cc470d184">cleanup_solver</a>(&amp;host_solver, &amp;device_solver);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    free(y_temp);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    free(host_mech);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    free(host_solver);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    free(result_flag);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a>( cudaDeviceReset() );</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;}</div><div class="ttc" id="solver__main_8cu_html_a4f005e7918ecc7f1cd2424fb1708b2ca"><div class="ttname"><a href="solver__main_8cu.html#a4f005e7918ecc7f1cd2424fb1708b2ca">write_log</a></div><div class="ttdeci">void write_log(int NUM, double t, const double *y_host, FILE *pFile)</div><div class="ttdoc">Writes state vectors to file. </div><div class="ttdef"><b>Definition:</b> <a href="solver__main_8cu_source.html#l00057">solver_main.cu:57</a></div></div>
<div class="ttc" id="solver__main_8cu_html_acfaf06165e3e00cb81ebbcd80ee9c23f"><div class="ttname"><a href="solver__main_8cu.html#acfaf06165e3e00cb81ebbcd80ee9c23f">memcpy2D_out</a></div><div class="ttdeci">void memcpy2D_out(double *dst, const int pitch_dst, double const *src, const int pitch_src, const int offset, const size_t width, const int height)</div><div class="ttdoc">A convienience method to copy memory between host pointers of different pitches, widths and heights...</div><div class="ttdef"><b>Definition:</b> <a href="solver__main_8cu_source.html#l00120">solver_main.cu:120</a></div></div>
<div class="ttc" id="launch__bounds_8cuh_html_ae53274b00308b1ad9b200ad750383abd"><div class="ttname"><a href="launch__bounds_8cuh.html#ae53274b00308b1ad9b200ad750383abd">TARGET_BLOCK_SIZE</a></div><div class="ttdeci">#define TARGET_BLOCK_SIZE</div><div class="ttdoc">The target number of threads per block. </div><div class="ttdef"><b>Definition:</b> <a href="launch__bounds_8cuh_source.html#l00010">launch_bounds.cuh:10</a></div></div>
<div class="ttc" id="namespacegenericcu_html_af403dabfc12de79ff9ab8575983d6f83"><div class="ttname"><a href="namespacegenericcu.html#af403dabfc12de79ff9ab8575983d6f83">genericcu::check_error</a></div><div class="ttdeci">__host__ void check_error(int num_conditions, int *code_arr)</div><div class="ttdef"><b>Definition:</b> <a href="radau2a__props_8cu_source.html#l00015">radau2a_props.cu:15</a></div></div>
<div class="ttc" id="solver__options_8cuh_html_afd8c973bc66908100d15f47ae514ed41"><div class="ttname"><a href="solver__options_8cuh.html#afd8c973bc66908100d15f47ae514ed41">DIVERGENCE_TEST</a></div><div class="ttdeci">#define DIVERGENCE_TEST</div><div class="ttdef"><b>Definition:</b> <a href="solver__options_8cuh_source.html#l00079">solver_options.cuh:79</a></div></div>
<div class="ttc" id="namespacegenericcu_html_aebd994cd8979f067bd672588910d33b5"><div class="ttname"><a href="namespacegenericcu.html#aebd994cd8979f067bd672588910d33b5">genericcu::padded</a></div><div class="ttdeci">int padded</div><div class="ttdoc">Padded # of ODEs to solve. </div><div class="ttdef"><b>Definition:</b> <a href="solver__interface_8cu_source.html#l00018">solver_interface.cu:18</a></div></div>
<div class="ttc" id="namespacegenericcu_html_a8afbde3cf8ec319556ccaa155d260d48"><div class="ttname"><a href="namespacegenericcu.html#a8afbde3cf8ec319556ccaa155d260d48">genericcu::device_mech</a></div><div class="ttdeci">mechanism_memory * device_mech</div><div class="ttdef"><b>Definition:</b> <a href="solver__interface_8cu_source.html#l00022">solver_interface.cu:22</a></div></div>
<div class="ttc" id="solver__main_8cu_html_a67cdbf6535bef9d8f0227e8340e7fe0a"><div class="ttname"><a href="solver__main_8cu.html#a67cdbf6535bef9d8f0227e8340e7fe0a">integrator_steps</a></div><div class="ttdeci">__device__ int integrator_steps[DIVERGENCE_TEST]</div><div class="ttdoc">If DIVERGENCE_TEST is defined, this creates a device array for tracking. </div><div class="ttdef"><b>Definition:</b> <a href="solver__main_8cu_source.html#l00042">solver_main.cu:42</a></div></div>
<div class="ttc" id="namespacecvode_html_af7eb796b6829fecab506fb6dfec39be0"><div class="ttname"><a href="namespacecvode.html#af7eb796b6829fecab506fb6dfec39be0">cvode::solver_log</a></div><div class="ttdeci">void solver_log()</div><div class="ttdef"><b>Definition:</b> <a href="cvodes__init_8c_source.html#l00192">cvodes_init.c:192</a></div></div>
<div class="ttc" id="header_8cuh_html_aa86864581d2574ded23a182874b81f4c"><div class="ttname"><a href="header_8cuh.html#aa86864581d2574ded23a182874b81f4c">NSP</a></div><div class="ttdeci">#define NSP</div><div class="ttdoc">The IVP system size. </div><div class="ttdef"><b>Definition:</b> <a href="header_8cuh_source.html#l00020">header.cuh:20</a></div></div>
<div class="ttc" id="namespacegenericcu_html_ab05c3172a90dd7ba99f0829b5940e52e"><div class="ttname"><a href="namespacegenericcu.html#ab05c3172a90dd7ba99f0829b5940e52e">genericcu::host_mech</a></div><div class="ttdeci">mechanism_memory * host_mech</div><div class="ttdoc">The mechanism memory structs. </div><div class="ttdef"><b>Definition:</b> <a href="solver__interface_8cu_source.html#l00022">solver_interface.cu:22</a></div></div>
<div class="ttc" id="namespacecvode_html_a3a26024b8dc2ce6f8b2afcfb7c82c79f"><div class="ttname"><a href="namespacecvode.html#a3a26024b8dc2ce6f8b2afcfb7c82c79f">cvode::solver_name</a></div><div class="ttdeci">const char * solver_name()</div><div class="ttdoc">Returns a descriptive solver name. </div><div class="ttdef"><b>Definition:</b> <a href="cvodes__init_8c_source.html#l00181">cvodes_init.c:181</a></div></div>
<div class="ttc" id="timer_8h_html"><div class="ttname"><a href="timer_8h.html">timer.h</a></div><div class="ttdoc">Timer interface for Linux. </div></div>
<div class="ttc" id="solver__options_8cuh_html_aaeb7127cf3bf0b49cec6554fbc101866"><div class="ttname"><a href="solver__options_8cuh.html#aaeb7127cf3bf0b49cec6554fbc101866">t_step</a></div><div class="ttdeci">#define t_step</div><div class="ttdef"><b>Definition:</b> <a href="solver__options_8cuh_source.html#l00026">solver_options.cuh:26</a></div></div>
<div class="ttc" id="namespacegenericcu_html_a5dd31ddb679f9bc301355945a04698db"><div class="ttname"><a href="namespacegenericcu.html#a5dd31ddb679f9bc301355945a04698db">genericcu::dimGrid</a></div><div class="ttdeci">dim3 dimGrid</div><div class="ttdef"><b>Definition:</b> <a href="solver__interface_8cu_source.html#l00024">solver_interface.cu:24</a></div></div>
<div class="ttc" id="namespacevan__der__pol__cu_html_a0bf56007d0b7d30d68223d2febfcc090"><div class="ttname"><a href="namespacevan__der__pol__cu.html#a0bf56007d0b7d30d68223d2febfcc090">van_der_pol_cu::apply_reverse_mask</a></div><div class="ttdeci">void apply_reverse_mask(double *y_host)</div><div class="ttdoc">Not needed for van der Pol. </div><div class="ttdef"><b>Definition:</b> <a href="ics_8cu_source.html#l00053">ics.cu:53</a></div></div>
<div class="ttc" id="namespacevan__der__pol__cu_html_a335500438eecc1a53d27911bdb50bd6e"><div class="ttname"><a href="namespacevan__der__pol__cu.html#a335500438eecc1a53d27911bdb50bd6e">van_der_pol_cu::initialize_gpu_memory</a></div><div class="ttdeci">void initialize_gpu_memory(int padded, mechanism_memory **h_mem, mechanism_memory **d_mem)</div><div class="ttdoc">Initializes the host and device mechanism_memory structs. This is required in order to enable passing...</div><div class="ttdef"><b>Definition:</b> <a href="gpu__memory_8cu_source.html#l00037">gpu_memory.cu:37</a></div></div>
<div class="ttc" id="namespacevan__der__pol__cu_html_a40f4f15256b20b377f4b76c325eceae2"><div class="ttname"><a href="namespacevan__der__pol__cu.html#a40f4f15256b20b377f4b76c325eceae2">van_der_pol_cu::free_gpu_memory</a></div><div class="ttdeci">void free_gpu_memory(mechanism_memory **h_mem, mechanism_memory **d_mem)</div><div class="ttdoc">Frees the host and device mechanism_memory structs. </div><div class="ttdef"><b>Definition:</b> <a href="gpu__memory_8cu_source.html#l00057">gpu_memory.cu:57</a></div></div>
<div class="ttc" id="timer_8h_html_a66509b494102a5c28ba6c8be3eab7733"><div class="ttname"><a href="timer_8h.html#a66509b494102a5c28ba6c8be3eab7733">StartTimer</a></div><div class="ttdeci">void StartTimer()</div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00043">timer.h:43</a></div></div>
<div class="ttc" id="namespacecvode_html_abe146525cea80d8032cd30b4441b5872"><div class="ttname"><a href="namespacecvode.html#abe146525cea80d8032cd30b4441b5872">cvode::initialize_solver</a></div><div class="ttdeci">void initialize_solver(int num_threads)</div><div class="ttdoc">Initializes the solver. </div><div class="ttdef"><b>Definition:</b> <a href="cvodes__init_8c_source.html#l00049">cvodes_init.c:49</a></div></div>
<div class="ttc" id="solver__main_8cu_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="solver__main_8cu.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="solver__main_8cu_source.html#l00148">solver_main.cu:148</a></div></div>
<div class="ttc" id="namespacegenericcu_html_a9a062af7a496f339320cfccf270a7c0e"><div class="ttname"><a href="namespacegenericcu.html#a9a062af7a496f339320cfccf270a7c0e">genericcu::y_temp</a></div><div class="ttdeci">double * y_temp</div><div class="ttdoc">temorary storage </div><div class="ttdef"><b>Definition:</b> <a href="solver__interface_8cu_source.html#l00028">solver_interface.cu:28</a></div></div>
<div class="ttc" id="namespacegenericcu_html_a95e70ae54ccfc5eb00792846ca80ecde"><div class="ttname"><a href="namespacegenericcu.html#a95e70ae54ccfc5eb00792846ca80ecde">genericcu::required_solver_size</a></div><div class="ttdeci">size_t required_solver_size()</div><div class="ttdoc">Returns the total size (in bytes) required for memory storage for a single GPU thread Used in calcula...</div><div class="ttdef"><b>Definition:</b> <a href="exp4__init_8cu_source.html#l00167">exp4_init.cu:167</a></div></div>
<div class="ttc" id="namespacegenericcu_html_a3bd8f6f5ff530e0031fad8d4771c3324"><div class="ttname"><a href="namespacegenericcu.html#a3bd8f6f5ff530e0031fad8d4771c3324">genericcu::dimBlock</a></div><div class="ttdeci">dim3 dimBlock</div><div class="ttdoc">block and grid sizes </div><div class="ttdef"><b>Definition:</b> <a href="solver__interface_8cu_source.html#l00024">solver_interface.cu:24</a></div></div>
<div class="ttc" id="solver_8cuh_html"><div class="ttname"><a href="solver_8cuh.html">solver.cuh</a></div><div class="ttdoc">the generic main file for all GPU solvers </div></div>
<div class="ttc" id="namespacevan__der__pol__cu_html_aa12c20164ea5113a104bfe974fa7147a"><div class="ttname"><a href="namespacevan__der__pol__cu.html#aa12c20164ea5113a104bfe974fa7147a">van_der_pol_cu::set_same_initial_conditions</a></div><div class="ttdeci">void set_same_initial_conditions(int NUM, double **y_host, double **var_host)</div><div class="ttdoc">Set same ICs for all problems. </div><div class="ttdef"><b>Definition:</b> <a href="ics_8cu_source.html#l00025">ics.cu:25</a></div></div>
<div class="ttc" id="solver__main_8cu_html_a8baeaa804b9d16c49da2b8c74fbd6680"><div class="ttname"><a href="solver__main_8cu.html#a8baeaa804b9d16c49da2b8c74fbd6680">memcpy2D_in</a></div><div class="ttdeci">void memcpy2D_in(double *dst, const int pitch_dst, double const *src, const int pitch_src, const int offset, const size_t width, const int height)</div><div class="ttdoc">A convienience method to copy memory between host pointers of different pitches, widths and heights...</div><div class="ttdef"><b>Definition:</b> <a href="solver__main_8cu_source.html#l00094">solver_main.cu:94</a></div></div>
<div class="ttc" id="header_8cuh_html"><div class="ttname"><a href="header_8cuh.html">header.cuh</a></div><div class="ttdoc">An example header file that defines system size, memory functions and other required methods for inte...</div></div>
<div class="ttc" id="namespacecvode_html_ac9bc4957bff6721dae9d7e4cc470d184"><div class="ttname"><a href="namespacecvode.html#ac9bc4957bff6721dae9d7e4cc470d184">cvode::cleanup_solver</a></div><div class="ttdeci">void cleanup_solver(int num_threads)</div><div class="ttdoc">Cleans up the created solvers. </div><div class="ttdef"><b>Definition:</b> <a href="cvodes__init_8c_source.html#l00165">cvodes_init.c:165</a></div></div>
<div class="ttc" id="gpu__macros_8cuh_html_a30443b62930197b53c467b008efd5a52"><div class="ttname"><a href="gpu__macros_8cuh.html#a30443b62930197b53c467b008efd5a52">cudaErrorCheck</a></div><div class="ttdeci">#define cudaErrorCheck(ans)</div><div class="ttdef"><b>Definition:</b> <a href="gpu__macros_8cuh_source.html#l00026">gpu_macros.cuh:26</a></div></div>
<div class="ttc" id="read__initial__conditions_8cuh_html"><div class="ttname"><a href="read__initial__conditions_8cuh.html">read_initial_conditions.cuh</a></div><div class="ttdoc">definition of the generic initial condition reader </div></div>
<div class="ttc" id="timer_8h_html_ab9a9e5a3142f8bbd781192e032d74c66"><div class="ttname"><a href="timer_8h.html#ab9a9e5a3142f8bbd781192e032d74c66">GetTimer</a></div><div class="ttdeci">double GetTimer()</div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00060">timer.h:60</a></div></div>
<div class="ttc" id="gpu__memory_8cuh_html"><div class="ttname"><a href="gpu__memory_8cuh.html">gpu_memory.cuh</a></div><div class="ttdoc">Headers for GPU memory initialization. </div></div>
<div class="ttc" id="namespacecvode_html_a9113d5fb0e19fa927d73b64c397ecd09"><div class="ttname"><a href="namespacecvode.html#a9113d5fb0e19fa927d73b64c397ecd09">cvode::init_solver_log</a></div><div class="ttdeci">void init_solver_log()</div><div class="ttdef"><b>Definition:</b> <a href="cvodes__init_8c_source.html#l00190">cvodes_init.c:190</a></div></div>
<div class="ttc" id="namespacegenericcu_html_a5f7029a718ffe15c6904855ec8344fde"><div class="ttname"><a href="namespacegenericcu.html#a5f7029a718ffe15c6904855ec8344fde">genericcu::result_flag</a></div><div class="ttdeci">int * result_flag</div><div class="ttdoc">result flag </div><div class="ttdef"><b>Definition:</b> <a href="solver__interface_8cu_source.html#l00026">solver_interface.cu:26</a></div></div>
<div class="ttc" id="read__initial__conditions_8c_html_a79be377a219a9ab2ae5c3a313b33afed"><div class="ttname"><a href="read__initial__conditions_8c.html#a79be377a219a9ab2ae5c3a313b33afed">read_initial_conditions</a></div><div class="ttdeci">void read_initial_conditions(const char *filename, int NUM, double **y_host, double **variable_host)</div><div class="ttdoc">Reads initial conditions for IVPs from binary file. </div><div class="ttdef"><b>Definition:</b> <a href="read__initial__conditions_8c_source.html#l00030">read_initial_conditions.c:30</a></div></div>
<div class="ttc" id="namespacevan__der__pol__cu_html_ad0a58342699dfa097a60b242293f4934"><div class="ttname"><a href="namespacevan__der__pol__cu.html#ad0a58342699dfa097a60b242293f4934">van_der_pol_cu::required_mechanism_size</a></div><div class="ttdeci">size_t required_mechanism_size()</div><div class="ttdoc">Calculates and returns the total memory size (in bytes) required by an individual thread for the mech...</div><div class="ttdef"><b>Definition:</b> <a href="gpu__memory_8cu_source.html#l00017">gpu_memory.cu:17</a></div></div>
<div class="ttc" id="structsolver__memory_html"><div class="ttname"><a href="structsolver__memory.html">solver_memory</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__props_8cuh_source.html#l00016">solver_props.cuh:16</a></div></div>
<div class="ttc" id="launch__bounds_8cuh_html"><div class="ttname"><a href="launch__bounds_8cuh.html">launch_bounds.cuh</a></div><div class="ttdoc">A number of definitions that control CUDA kernel launches. </div></div>
<div class="ttc" id="solver__interface_8cuh_html_a6ebf6899d6c1c8b7b9d09be872c05aae"><div class="ttname"><a href="solver__interface_8cuh.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a></div><div class="ttdeci">#define EPS</div><div class="ttdef"><b>Definition:</b> <a href="solver__interface_8cuh_source.html#l00024">solver_interface.cuh:24</a></div></div>
<div class="ttc" id="header_8cuh_html_a170755e30c36be4904106b7bb279b1ec"><div class="ttname"><a href="header_8cuh.html#a170755e30c36be4904106b7bb279b1ec">NN</a></div><div class="ttdeci">#define NN</div><div class="ttdoc">Input vector size (in read_initial_conditions) </div><div class="ttdef"><b>Definition:</b> <a href="header_8cuh_source.html#l00022">header.cuh:22</a></div></div>
<div class="ttc" id="solver__options_8cuh_html_a25526ead9bdb589c90e7a8d3b4d1a746"><div class="ttname"><a href="solver__options_8cuh.html#a25526ead9bdb589c90e7a8d3b4d1a746">end_time</a></div><div class="ttdeci">#define end_time</div><div class="ttdef"><b>Definition:</b> <a href="solver__options_8cuh_source.html#l00028">solver_options.cuh:28</a></div></div>
<div class="ttc" id="namespacegenericcu_html_ab055dd890b1213d13abf8c541e4a09eb"><div class="ttname"><a href="namespacegenericcu.html#ab055dd890b1213d13abf8c541e4a09eb">genericcu::host_solver</a></div><div class="ttdeci">solver_memory * host_solver</div><div class="ttdoc">The solver memory structs. </div><div class="ttdef"><b>Definition:</b> <a href="solver__interface_8cu_source.html#l00020">solver_interface.cu:20</a></div></div>
<div class="ttc" id="namespacegenericcu_html_acb75b0bf572d5107ee76511410038a46"><div class="ttname"><a href="namespacegenericcu.html#acb75b0bf572d5107ee76511410038a46">genericcu::device_solver</a></div><div class="ttdeci">solver_memory * device_solver</div><div class="ttdef"><b>Definition:</b> <a href="solver__interface_8cu_source.html#l00020">solver_interface.cu:20</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
